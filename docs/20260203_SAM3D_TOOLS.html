<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAM3D Tools Reference</title>
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --accent-blue: #58a6ff;
            --accent-green: #3fb950;
            --accent-purple: #a371f7;
            --accent-orange: #d29922;
            --accent-red: #f85149;
            --border-color: #30363d;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 2rem;
        }
        
        .container { max-width: 1100px; margin: 0 auto; }
        
        h1 { font-size: 2rem; margin-bottom: 0.5rem; color: var(--accent-blue); }
        .subtitle { color: var(--text-secondary); margin-bottom: 2rem; }
        
        .section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        h2 { font-size: 1.3rem; margin-bottom: 1rem; color: var(--accent-green); }
        h3 { font-size: 1.1rem; margin: 1rem 0 0.5rem 0; color: var(--accent-purple); }
        
        code {
            background: var(--bg-tertiary);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            color: var(--accent-orange);
        }
        
        pre {
            background: var(--bg-tertiary);
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 0.85rem;
            margin: 1rem 0;
        }
        
        pre code { background: none; padding: 0; }
        
        table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
        th, td { border: 1px solid var(--border-color); padding: 0.75rem; text-align: left; }
        th { background: var(--bg-tertiary); color: var(--accent-blue); }
        
        .tool-card {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .tool-card h4 {
            color: var(--accent-blue);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .tool-card .path { color: var(--text-secondary); font-size: 0.85rem; font-family: monospace; }
        .tool-card p { margin: 0.5rem 0; color: var(--text-secondary); }
        
        .timestamp {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß SAM3D Tools Reference</h1>
        <p class="subtitle">Command-line tools for SAM3D workflow: generation, visualization, and post-processing</p>
        
        <div class="section">
            <h2>üìÅ Tool Overview</h2>
            
            <table>
                <tr>
                    <th>Tool</th>
                    <th>Purpose</th>
                    <th>Input</th>
                    <th>Output</th>
                </tr>
                <tr>
                    <td><code>sam3d_worker.py</code></td>
                    <td>Run SAM3D inference</td>
                    <td>Image + Mask + Config</td>
                    <td>GLB mesh</td>
                </tr>
                <tr>
                    <td><code>downsample_pointcloud.py</code></td>
                    <td>Reduce point count</td>
                    <td>GLB/PLY</td>
                    <td>PLY</td>
                </tr>
                <tr>
                    <td><code>render_pointcloud.py</code></td>
                    <td>Quick preview (Open3D)</td>
                    <td>GLB/PLY</td>
                    <td>PNG</td>
                </tr>
                <tr>
                    <td><code>blender_render_rotation.py</code></td>
                    <td>High-quality rotation render</td>
                    <td>GLB</td>
                    <td>PNG frames</td>
                </tr>
                <tr>
                    <td><code>create_gifs.py</code></td>
                    <td>Create ping-pong GIFs</td>
                    <td>PNG frames</td>
                    <td>GIF</td>
                </tr>
            </table>
        </div>
        
        <div class="section">
            <h2>üéØ SAM3D Inference</h2>
            
            <div class="tool-card">
                <h4>üì¶ sam3d_worker.py</h4>
                <div class="path">tools/sam3d/sam3d_worker.py</div>
                <p>Run SAM3D (TRELLIS) to generate 3D mesh from image + mask.</p>
            </div>
            
            <h3>Usage</h3>
            <pre><code>$env:PYTHONPATH = "D:\Projects\ProjectGenesis\GenesisVIGA"
conda run -n sam3d_py311 python tools/sam3d/sam3d_worker.py `
    --image "input.png" `
    --mask "mask.npy" `
    --config "utils/third_party/sam3d/checkpoints/hf/checkpoints/pipeline.yaml" `
    --glb "output.glb"</code></pre>
            
            <h3>Arguments</h3>
            <table>
                <tr><th>Argument</th><th>Description</th></tr>
                <tr><td><code>--image</code></td><td>Input RGB image (PNG)</td></tr>
                <tr><td><code>--mask</code></td><td>Binary mask (NPY or PNG)</td></tr>
                <tr><td><code>--config</code></td><td>Pipeline config YAML</td></tr>
                <tr><td><code>--glb</code></td><td>Output GLB path</td></tr>
            </table>
            
            <h3>Environment</h3>
            <pre><code>Conda: sam3d_py311
Python: 3.11.14
PyTorch: 2.8.0+cu128
CUDA: 12.8</code></pre>
        </div>
        
        <div class="section">
            <h2>üìâ Point Cloud Processing</h2>
            
            <div class="tool-card">
                <h4>üìâ downsample_pointcloud.py</h4>
                <div class="path">tools/downsample_pointcloud.py</div>
                <p>Reduce point count using voxel, uniform, or random downsampling.</p>
            </div>
            
            <h3>Usage</h3>
            <pre><code># View point cloud info
python tools/downsample_pointcloud.py input.glb --info

# Voxel downsample (merge nearby points)
python tools/downsample_pointcloud.py input.glb --voxel 0.01 -o output.ply

# Uniform downsample (keep every Nth point)
python tools/downsample_pointcloud.py input.glb --uniform 2 -o output.ply

# Random downsample (keep X%)
python tools/downsample_pointcloud.py input.glb --random 0.5 -o output.ply</code></pre>
            
            <h3>Downsample Methods</h3>
            <table>
                <tr><th>Method</th><th>Parameter</th><th>Effect</th></tr>
                <tr><td>Voxel</td><td><code>--voxel 0.01</code></td><td>Merge points within 0.01 unit voxels</td></tr>
                <tr><td>Uniform</td><td><code>--uniform 4</code></td><td>Keep every 4th point (25%)</td></tr>
                <tr><td>Random</td><td><code>--random 0.3</code></td><td>Randomly keep 30% of points</td></tr>
            </table>
        </div>
        
        <div class="section">
            <h2>üé® Visualization</h2>
            
            <div class="tool-card">
                <h4>üëÅÔ∏è render_pointcloud.py (Open3D - Fast Preview)</h4>
                <div class="path">tools/render_pointcloud.py</div>
                <p>Quick point cloud rendering using Open3D. Good for fast previews.</p>
            </div>
            
            <pre><code># Single view
python tools/render_pointcloud.py input.ply --view front -o output.png

# Multiple preset views
python tools/render_pointcloud.py input.ply --all-views --output-dir renders/

# Views: front, back, left, right, top, bottom, iso, iso2, iso3, iso4</code></pre>
            
            <div class="tool-card">
                <h4>üé¨ blender_render_rotation.py (Blender - High Quality)</h4>
                <div class="path">tools/blender_render_rotation.py</div>
                <p>High-quality rotation animation using Blender Cycles. <strong>Rotates object, not camera</strong> (avoids gimbal lock).</p>
            </div>
            
            <pre><code># Render 30 frames per axis
blender --background --python tools/blender_render_rotation.py -- input.glb output_dir --frames 30</code></pre>
            
            <h3>Key Technique: Rotate Object, Not Camera</h3>
            <table>
                <tr><th>Approach</th><th>Result</th></tr>
                <tr><td>‚ùå Rotate camera position</td><td>Gimbal lock at top/bottom</td></tr>
                <tr><td>‚ùå Track-To constraint</td><td>Sudden angle jumps</td></tr>
                <tr><td>‚úÖ Rotate object with quaternion</td><td>Smooth 360¬∞ rotation</td></tr>
            </table>
            
            <div class="tool-card">
                <h4>üéûÔ∏è create_gifs.py</h4>
                <div class="path">tools/create_gifs.py</div>
                <p>Create ping-pong GIFs (1‚Üí30‚Üí1) from rendered frames.</p>
            </div>
            
            <pre><code>python tools/create_gifs.py output_dir</code></pre>
        </div>
        
        <div class="section">
            <h2>üîÑ Complete Workflow</h2>
            
            <pre><code># 1. Run SAM3D to generate GLB
$env:PYTHONPATH = "D:\Projects\ProjectGenesis\GenesisVIGA"
conda run -n sam3d_py311 python tools/sam3d/sam3d_worker.py `
    --image input.png --mask mask.npy `
    --config utils/third_party/sam3d/checkpoints/hf/checkpoints/pipeline.yaml `
    --glb output.glb

# 2. Render rotation animation with Blender
blender --background --python tools/blender_render_rotation.py -- output.glb renders/ --frames 30

# 3. Create GIFs
python tools/create_gifs.py renders/

# Output:
#   renders/{name}_y_rotation.gif  (turntable)
#   renders/{name}_x_rotation.gif  (tumble)</code></pre>
        </div>
        
        <div class="section">
            <h2>üìö Related Documentation</h2>
            <ul>
                <li><a href="20260203_SAM3D_INTERNALS.html" style="color: var(--accent-blue);">SAM3D Internals</a> - Pipeline stages, parameters, VRAM optimization</li>
                <li><a href="20260203_VIGA_ARCHITECTURE.html" style="color: var(--accent-blue);">VIGA Architecture</a> - VIGA ‚Üí SAM3D ‚Üí TRELLIS hierarchy</li>
                <li><a href="20260203_SAM3D_BOTTLE_TEST.html" style="color: var(--accent-blue);">SAM3D Bottle Test</a> - Successful test results</li>
            </ul>
        </div>
        
        <p class="timestamp">
            üìÖ Created: 2026-02-03 19:54 PST<br>
            ü§ñ Author: Yuna
        </p>
    </div>
</body>
</html>
<!-- Created by Yuna -->